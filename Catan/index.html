<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Catan Tabletop</title>
    <link rel="stylesheet" href="./style.css" />
    <script src="./app.js" defer></script>
  </head>
  <body>
    <div class="app-shell">
      <header class="topbar">
        <h1>Catan Tabletop</h1>
        <p>A polished strategy board experience inspired by Catan Universe</p>
      </header>

      <main class="layout">
        <section class="board-panel">
          <div class="board-stage">
            <div class="left-action-stack">
              <section id="buildActionPopup" class="build-action-popup hidden">
                <h3>Build</h3>
                <div class="mode-grid">
                  <button class="mode-btn" data-mode="none">Clear</button>
                  <button class="mode-btn" data-mode="road">Road</button>
                  <button class="mode-btn" data-mode="settlement">Settlement</button>
                  <button class="mode-btn" data-mode="city">City</button>
                </div>
              </section>
              <section id="tradePromptPopup" class="build-action-popup trade-prompt-popup hidden">
                <h3>Trade</h3>
                <button id="openTradeMenuBtn">Open Trade Menu</button>
              </section>
              <section id="tradeActionPopup" class="build-action-popup trade-action-popup hidden">
                <div class="trade-popup-head">
                  <h3>Trade</h3>
                  <button id="closeTradeMenuBtn" type="button">Close</button>
                </div>
                <div class="trade-popup-grid">
                  <div id="bankTradeSection" class="trade-popup-card">
                    <h4>Bank (4:1)</h4>
                    <div class="row trade-popup-row">
                      <label for="tradeGive">Give</label>
                      <select id="tradeGive"></select>
                    </div>
                    <div class="row trade-popup-row">
                      <label for="tradeGet">Get</label>
                      <select id="tradeGet"></select>
                    </div>
                    <button id="tradeBtn">Trade</button>
                    <p id="bankTradeHint" class="trade-hint"></p>
                  </div>

                  <div id="playerTradeSection" class="trade-popup-card">
                    <h4>Player</h4>
                    <div class="row trade-popup-row">
                      <label for="p2pTarget">With</label>
                      <select id="p2pTarget"></select>
                    </div>
                    <div class="row trade-row trade-popup-row">
                      <label for="p2pGive">Give</label>
                      <select id="p2pGive"></select>
                      <input id="p2pGiveAmount" type="number" min="1" step="1" value="1" />
                    </div>
                    <div class="row trade-row trade-popup-row">
                      <label for="p2pGet">Get</label>
                      <select id="p2pGet"></select>
                      <input id="p2pGetAmount" type="number" min="1" step="1" value="1" />
                    </div>
                    <button id="p2pTradeBtn">Propose Trade</button>
                    <p id="p2pTradeHint" class="trade-hint"></p>
                  </div>
                </div>
              </section>
            </div>
            <div class="board-top-right">
              <button
                id="histogramToggleBtn"
                class="histogram-toggle-btn hidden"
                type="button"
                aria-pressed="false"
                aria-controls="rollHistogram"
              >
                Rolls
              </button>
              <div id="turnBadge" class="turn-badge hidden">
                <span class="turn-badge-dot" id="turnBadgeDot" aria-hidden="true"></span>
                <span id="turnBadgeText">Start a game</span>
              </div>
            </div>
            <div id="turnClock" class="turn-clock hidden" aria-hidden="true">
              <span id="turnClockText" class="turn-clock-text">0</span>
            </div>
            <div id="diceRollStage" class="dice-roll-stage hidden" aria-hidden="true">
              <div id="boardDieA" class="board-die die-a" data-face="1" aria-hidden="true">
                <div class="die-cube">
                  <div class="die-face face-front" data-value="1"></div>
                  <div class="die-face face-back" data-value="6"></div>
                  <div class="die-face face-right" data-value="3"></div>
                  <div class="die-face face-left" data-value="4"></div>
                  <div class="die-face face-top" data-value="2"></div>
                  <div class="die-face face-bottom" data-value="5"></div>
                </div>
              </div>
              <div id="boardDieB" class="board-die die-b" data-face="2" aria-hidden="true">
                <div class="die-cube">
                  <div class="die-face face-front" data-value="1"></div>
                  <div class="die-face face-back" data-value="6"></div>
                  <div class="die-face face-right" data-value="3"></div>
                  <div class="die-face face-left" data-value="4"></div>
                  <div class="die-face face-top" data-value="2"></div>
                  <div class="die-face face-bottom" data-value="5"></div>
                </div>
              </div>
            </div>
            <div id="rollResultPopup" class="roll-result-popup hidden" aria-hidden="true"></div>
            <aside id="rollHistogram" class="roll-histogram-panel hidden" aria-hidden="true"></aside>
            <svg id="board" aria-label="Catan board"></svg>
          </div>
          <section class="board-hud">
            <div class="hud-top">
              <h2>Table Stats</h2>
              <div id="buildPanel" class="build-panel"></div>
            </div>
            <div id="tableStats" class="table-stats"></div>
          </section>
        </section>

        <aside class="side-panel">
          <section class="card" id="setupCard">
            <h2>Game Setup</h2>
            <div id="setupFields">
              <div class="row">
                <label for="playerCount">Players</label>
                <select id="playerCount">
                  <option value="3">3</option>
                  <option value="4">4</option>
                </select>
              </div>
              <div class="row">
                <label for="turnSeconds">Turn Timer (sec)</label>
                <input id="turnSeconds" type="number" min="10" step="1" value="60" />
              </div>
              <div id="nameInputs"></div>
            </div>
            <button id="startBtn">Start New Game</button>
            <button id="restartBtn" class="hidden">Restart Game</button>
          </section>

          <section class="card" id="turnCard">
            <h2>Turn</h2>
            <p><strong>Phase:</strong> <span id="phaseLabel">Pregame</span></p>
            <p><strong>Current:</strong> <span id="currentPlayerLabel">-</span></p>
            <div class="row actions">
              <button id="rollBtn">Roll Dice</button>
              <button id="endTurnBtn">End Turn</button>
            </div>
            <p><strong>Dice:</strong> <span id="diceLabel">-</span></p>
            <p id="turnCallout" class="turn-callout">Set players and start.</p>
            <p id="statusText">Set players and start.</p>
          </section>

          <section class="card log-card">
            <h2>Game Log</h2>
            <ul id="logList"></ul>
          </section>
        </aside>
      </main>
    </div>

    <div id="actionModal" class="action-modal hidden" aria-hidden="true">
      <div class="action-modal-card">
        <h3 id="actionModalTitle"></h3>
        <p id="actionModalText"></p>
        <div id="actionModalOptions" class="action-modal-options"></div>
        <div class="action-modal-footer">
          <button id="actionModalCancelBtn">Cancel</button>
        </div>
      </div>
    </div>
  </body>
</html>
